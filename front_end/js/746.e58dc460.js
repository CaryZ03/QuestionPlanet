"use strict";(self["webpackChunkquestion_planet"]=self["webpackChunkquestion_planet"]||[]).push([[746],{3746:function(e,s,t){t.r(s),t.d(s,{default:function(){return h}});var a=function(){var e=this,s=e._self._c;return s("div",[s("LoginAndRegister")],1)},r=[],o=function(){var e=this,s=e._self._c;return s("div",{staticClass:"wrapper"},[e._m(0),s("div",{staticClass:"form-box login"},[s("h2",{staticStyle:{color:"aliceblue"}},[e._v("登录")]),s("form",{on:{submit:function(e){e.preventDefault()}}},[s("div",{staticClass:"input-box"},[e._m(1),s("input",{directives:[{name:"model",rawName:"v-model",value:e.user.username,expression:"user.username"}],attrs:{type:"text",required:""},domProps:{value:e.user.username},on:{input:function(s){s.target.composing||e.$set(e.user,"username",s.target.value)}}}),s("label",{staticStyle:{color:"aliceblue"}},[e._v("用户名")])]),s("div",{staticClass:"input-box"},[e._m(2),s("input",{directives:[{name:"model",rawName:"v-model",value:e.user.password,expression:"user.password"}],attrs:{type:"password",required:""},domProps:{value:e.user.password},on:{input:function(s){s.target.composing||e.$set(e.user,"password",s.target.value)}}}),s("label",{staticStyle:{color:"aliceblue"}},[e._v("密码")])]),s("div",{staticClass:"remember-forgot"},[s("label",[s("input",{directives:[{name:"model",rawName:"v-model",value:e.isRemember,expression:"isRemember"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(e.isRemember)?e._i(e.isRemember,null)>-1:e.isRemember},on:{change:function(s){var t=e.isRemember,a=s.target,r=!!a.checked;if(Array.isArray(t)){var o=null,i=e._i(t,o);a.checked?i<0&&(e.isRemember=t.concat([o])):i>-1&&(e.isRemember=t.slice(0,i).concat(t.slice(i+1)))}else e.isRemember=r}}}),e._v("记住密码")]),s("a",{staticStyle:{color:"aliceblue"},attrs:{href:""},on:{click:e.forgetPass}},[e._v("忘记密码")])]),s("button",{staticClass:"btn",on:{click:e.login}},[e._v("登录")]),e._m(3)])]),s("div",{staticClass:"form-box register"},[s("h2",{staticStyle:{color:"aliceblue"}},[e._v("注册 ")]),s("form",{on:{submit:function(e){e.preventDefault()}}},[s("div",{staticClass:"input-box"},[e._m(4),s("input",{directives:[{name:"model",rawName:"v-model",value:e.userR.username,expression:"userR.username"}],attrs:{type:"text",required:""},domProps:{value:e.userR.username},on:{input:function(s){s.target.composing||e.$set(e.userR,"username",s.target.value)}}}),s("label",{staticStyle:{color:"aliceblue"}},[e._v("用户名")])]),s("div",{staticClass:"input-box"},[e._m(5),s("input",{directives:[{name:"model",rawName:"v-model",value:e.userR.password1,expression:"userR.password1"}],attrs:{type:"password",required:""},domProps:{value:e.userR.password1},on:{input:function(s){s.target.composing||e.$set(e.userR,"password1",s.target.value)}}}),s("label",{staticStyle:{color:"aliceblue"}},[e._v("密码")])]),s("div",{staticClass:"input-box"},[e._m(6),s("input",{directives:[{name:"model",rawName:"v-model",value:e.userR.password2,expression:"userR.password2"}],attrs:{type:"password",required:""},domProps:{value:e.userR.password2},on:{input:function(s){s.target.composing||e.$set(e.userR,"password2",s.target.value)}}}),s("label",{staticStyle:{color:"aliceblue"}},[e._v("确认密码")])]),s("div",{staticClass:"remember-forgot"},[s("label",{staticStyle:{color:"aliceblue"}},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.isAgree,expression:"isAgree"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(e.isAgree)?e._i(e.isAgree,null)>-1:e.isAgree},on:{change:function(s){var t=e.isAgree,a=s.target,r=!!a.checked;if(Array.isArray(t)){var o=null,i=e._i(t,o);a.checked?i<0&&(e.isAgree=t.concat([o])):i>-1&&(e.isAgree=t.slice(0,i).concat(t.slice(i+1)))}else e.isAgree=r}}}),e._v(" 同意用户星球 "),s("a",{staticStyle:{color:"aliceblue"},attrs:{href:"https://www.wjx.cn/wjx/license.aspx"}},[e._v("用户协议")]),e._v(" 以及 "),s("a",{staticStyle:{color:"aliceblue"},attrs:{href:"https://www.wjx.cn/wjx/license.aspx?type=1"}},[e._v("隐私条款")])])]),s("button",{staticClass:"btn",on:{click:e.register}},[e._v("注册")]),e._m(7)])])])},i=[function(){var e=this,s=e._self._c;return s("span",{staticClass:"icon-close"},[s("i",{staticClass:"el-icon-close"})])},function(){var e=this,s=e._self._c;return s("span",{staticClass:"icon"},[s("i",{staticClass:"el-icon-edit"})])},function(){var e=this,s=e._self._c;return s("span",{staticClass:"icon"},[s("i",{staticClass:"el-icon-lock"})])},function(){var e=this,s=e._self._c;return s("div",{staticClass:"login-register"},[s("p",{staticStyle:{color:"aliceblue"}},[e._v("没有账号?"),s("a",{staticClass:"register-link",staticStyle:{color:"aliceblue"},attrs:{href:"#"}},[e._v("注册一个")])])])},function(){var e=this,s=e._self._c;return s("span",{staticClass:"icon"},[s("i",{staticClass:"el-icon-edit"})])},function(){var e=this,s=e._self._c;return s("span",{staticClass:"icon"},[s("i",{staticClass:"el-icon-lock"})])},function(){var e=this,s=e._self._c;return s("span",{staticClass:"icon"},[s("i",{staticClass:"el-icon-lock"})])},function(){var e=this,s=e._self._c;return s("div",{staticClass:"login-register"},[s("p",{staticStyle:{color:"aliceblue"}},[e._v("已有账号?"),s("a",{staticClass:"login-link",staticStyle:{color:"aliceblue"},attrs:{href:"#"}},[e._v("现在登录")])])])}],n=(t(7658),t(5114)),l=(t(7421),{data(){return{user:{username:"",password:""},userR:{username:"",password1:"",password2:""},userChange:{username:"",password1:"",password2:""},isAgree:!1,isRemember:!1}},methods:{async login(){const e=JSON.stringify(this.user);console.log(e),await this.$api.userInfo.postUserInfo_UserLogin(e).then((e=>{0===e.data["errno"]?(n.Message.success("登录成功"),console.log(e.data),this.$store.state.token_key=e.data["token_key"],console.log(e.data.token_key),console.log(e.data),console.log(e.data.uid),this.$store.state.curUserID=e.data["uid"],this.$store.state.curUsername=this.user.username,this.$store.state.isLogin=!0,localStorage.setItem("curUserID",this.$store.state.curUserID),localStorage.setItem("curUserName",this.$store.state.curUsername),localStorage.setItem("token",e.data["token_key"]),console.log("localStorage token register:"+localStorage.getItem("token")),localStorage.setItem("isLogin",!0),console.log(`/manage/${this.$store.state.curUserID}`),this.$router.push({path:`/manage/${this.$store.state.curUserID}`}),this.$api.userInfo.getUserInfo_CheckToken().then((e=>{console.log(e)}))):(n.Message.error(e.data.msg),console.log(e.data),console.log("发生了奇怪的问题"))})).catch((e=>{n.Message.error("登录失败"),console.log(e)}))},forgetPass(){const e={username:this.user.username};console.log("data.username"+e.username),this.$api.userInfo.postUserInfo_SendVeri(e).then((e=>{alert("what fuck"),0==e.data.errno?this.$prompt("请输入验证码","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then((({value:s})=>{console.log("value2:jsontring"+JSON.stringify(s)),console.log("value2:"+s),console.log("res.data.code"+e.data.code),s==e.data.code?(this.$message({type:"success",message:"验证码验证成功"}),this.$prompt("请输入新密码","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then((({value:e})=>{this.userChange.password1=e,this.userChange.password2=e;const s={username:this.user.username,password1:e,password2:e};this.$api.userInfo.postUserInfo_ResetPassword(s).then((e=>{0==e.data.errno?this.$message({type:"success",message:"修改成功"}):this.$message({type:"error",message:"修改失敗"})}))})).catch((()=>{this.$message({type:"info",message:"取消輸入"})}))):this.$message({type:"error",message:"验证码错误"})})).catch((()=>{this.$message({type:"info",message:"取消输入"})})):this.$message({type:"error",message:"验证码发送失败"})}))},register(){if(console.log("isagree:"+this.isAgree),!1===this.isAgree)n.Message.warning("请勾选用户协议");else{console.log("????????:");const e=JSON.stringify(this.userR);console.log(e),this.$api.userInfo.postUserInfo_Register(e).then((e=>{if(console.log(e.data),0==e.data.errno){n.Message.success("注册成功");const e=document.querySelector(".wrapper");e.classList.remove("active")}else console.log(e.data),1014==e.data.errno?n.Message.error("密码必须含有数字和字母，且为6~20位"):n.Message.error(e.data.msg)})).catch((e=>{n.Message.error("注册失败"),console.log(e)}))}}},mounted(){const e=document.querySelector(".wrapper"),s=document.querySelector(".login-link"),t=document.querySelector(".register-link");console.log(e);const a=document.querySelector(".btnLogin-popup"),r=document.querySelector(".icon-close");null!=e&&e.classList.add("active-popup"),this.$nextTick((()=>{null!=e&&null!=t&&t.addEventListener("click",(()=>{e.classList.add("active")})),null!=e&&null!=s&&s.addEventListener("click",(()=>{e.classList.remove("active")})),null!=e&&null!=a&&a.addEventListener("click",(()=>{e.classList.add("active-popup")})),null!=e&&null!=r&&r.addEventListener("click",(()=>{e.classList.remove("active-popup")}))}))}}),c=l,u=t(1001),m=(0,u.Z)(c,o,i,!1,null,"18686a0f",null),d=m.exports,p={data(){return{}},methods:{},components:{LoginAndRegister:d}},g=p,v=(0,u.Z)(g,a,r,!1,null,"1a059c4b",null),h=v.exports}}]);
//# sourceMappingURL=746.e58dc460.js.map